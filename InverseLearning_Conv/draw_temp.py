import matplotlib.pyplot as plt

#
# iresnet_lips = [0.8121862411499023, 0.8263536095619202, 0.8693440556526184, 0.9020560383796692, 0.9966424107551575, 1.0166330337524414, 1.1063249111175537, 1.2114607095718384, 1.2808077335357666, 1.3113428354263306, 1.4630287885665894, 1.6020746231079102, 1.6888294219970703, 1.742793321609497, 1.8579567670822144, 1.9566940069198608, 2.0271499156951904, 2.1779654026031494, 2.4068965911865234, 2.608887195587158, 2.802377462387085, 3.1748926639556885, 3.441802740097046, 4.067787170410156, 4.048027038574219, 4.21077823638916, 4.68568754196167, 4.493828773498535, 4.790516376495361, 5.13136625289917, 4.990862846374512, 5.542354106903076, 5.75035285949707, 6.007327079772949, 6.007428169250488, 6.037621974945068, 6.296937942504883, 6.574679851531982, 6.746609210968018, 6.9044880867004395, 7.540827751159668, 7.304720401763916, 7.2558135986328125, 7.079285621643066, 7.002521991729736, 7.363821029663086, 7.396358489990234, 7.337271690368652, 7.467178821563721, 7.451465606689453]
# resnet_lips = [0.8205103278160095, 1.2354673147201538, 5.896811008453369, 10.773021697998047, 12.26617431640625, 11.8272705078125, 11.231945991516113, 11.880779266357422, 14.64172649383545, 13.051780700683594, 12.633347511291504, 12.856369018554688, 15.866037368774414, 17.063302993774414, 16.329973220825195, 15.563969612121582, 15.120752334594727, 13.860235214233398, 13.737691879272461, 13.669340133666992, 16.00725746154785, 17.933853149414062, 16.574512481689453, 16.176097869873047, 15.308272361755371, 13.538276672363281, 12.42896556854248, 11.753872871398926, 11.337986946105957, 12.282922744750977, 11.874183654785156, 13.25146198272705, 13.084643363952637, 11.676956176757812, 11.853753089904785, 11.329429626464844, 11.518628120422363, 11.406614303588867, 10.173327445983887, 11.28798770904541, 11.940433502197266, 11.769465446472168, 10.960740089416504, 11.910052299499512, 10.674578666687012, 10.868803977966309, 11.178398132324219, 11.142651557922363, 10.823960304260254, 10.372247695922852]
# iresnet_lips_large_layerlips = [0.8147761225700378, 0.8460245132446289, 0.9102030992507935, 0.9305383563041687, 1.0217458009719849, 1.0810215473175049, 1.087356448173523, 1.1506128311157227, 1.1782948970794678, 1.225113034248352, 1.4046716690063477, 1.5633348226547241, 1.6686381101608276, 1.7118251323699951, 1.8771470785140991, 1.9742703437805176, 2.1072654724121094, 2.422865867614746, 2.6416852474212646, 2.7277660369873047, 2.958122968673706, 3.3504796028137207, 3.924071788787842, 4.29337739944458, 4.613099575042725, 4.593803405761719, 5.163205146789551, 4.93093729019165, 5.105415344238281, 5.585824489593506, 5.6380510330200195, 6.269354820251465, 6.344909191131592, 6.433305740356445, 6.393574237823486, 6.554568290710449, 6.791528701782227, 6.979837417602539, 7.194591999053955, 7.2801899909973145, 8.039315223693848, 8.118865013122559, 7.484429836273193, 7.354883670806885, 7.593015670776367, 7.862125396728516, 7.801758766174316, 7.992819309234619, 8.338705062866211, 8.095063209533691]
# iresnet_lips_no_padding =  [0.8109603524208069, 0.8301529288291931, 0.8480870127677917, 0.9163498282432556, 0.9948732256889343, 1.0714912414550781, 1.2396115064620972, 1.381953477859497, 1.4296859502792358, 1.5392638444900513, 1.5993893146514893, 1.7008880376815796, 1.7819441556930542, 1.8748555183410645, 1.9570229053497314, 2.095207929611206, 2.2190022468566895, 2.3354837894439697, 2.433114767074585, 2.582545042037964, 2.815704584121704, 3.0726938247680664, 3.3665144443511963, 3.4377872943878174, 3.798560857772827, 3.9787449836730957, 4.512485504150391, 4.488921642303467, 4.8336501121521, 5.047438621520996, 5.0926594734191895, 5.293724060058594, 5.674098968505859, 5.625212669372559, 5.706217288970947, 5.696328639984131, 5.804301738739014, 5.707178592681885, 6.036316871643066, 6.28435754776001, 6.208761215209961, 6.316486358642578, 6.143341541290283, 6.235506534576416, 6.413000106811523, 6.338021755218506, 6.223814964294434, 6.400649070739746, 6.393143177032471, 6.523037910461426]
#
# # iresnet_lips = [0.8121862411499023, 0.8263536095619202, 0.8693440556526184, 0.9020560383796692, 0.9966424107551575, 1.0166330337524414, 1.1063249111175537, 1.2114607095718384, 1.2808077335357666, 1.3113428354263306, 1.4630287885665894, 1.6020746231079102, 1.6888294219970703, 1.742793321609497, 1.8579567670822144, 1.9566940069198608, 2.0271499156951904, 2.1779654026031494, 2.4068965911865234, 2.608887195587158, 2.802377462387085, 3.1748926639556885, 3.441802740097046, 4.067787170410156, 4.048027038574219, 4.21077823638916, 4.68568754196167, 4.493828773498535, 4.790516376495361, 5.13136625289917, 4.990862846374512, 5.542354106903076, 5.75035285949707, 6.007327079772949, 6.007428169250488, 6.037621974945068, 6.296937942504883, 6.574679851531982, 6.746609210968018, 6.9044880867004395, 7.540827751159668, 7.304720401763916, 7.2558135986328125, 7.079285621643066, 7.002521991729736, 7.363821029663086, 7.396358489990234, 7.337271690368652, 7.467178821563721, 7.451465606689453, 7.804502487182617, 7.907585144042969, 7.651267051696777, 8.022991180419922, 8.127156257629395, 8.08702278137207, 8.534124374389648, 8.635780334472656, 8.31602668762207, 8.930268287658691, 8.706064224243164, 8.681376457214355, 8.745336532592773, 8.81935977935791, 8.812840461730957, 8.666854858398438, 8.6032075881958, 8.580745697021484, 8.711136817932129, 8.75174331665039, 8.773030281066895, 8.714303970336914, 8.805773735046387, 8.843633651733398, 8.798197746276855, 8.746164321899414, 8.713890075683594, 8.812414169311523, 8.878826141357422, 8.883668899536133, 8.953941345214844, 9.024409294128418, 8.994999885559082, 8.986810684204102, 9.079257011413574, 9.148540496826172, 9.091650009155273, 9.179976463317871, 9.253924369812012, 9.256712913513184, 9.228792190551758, 9.229655265808105, 9.326193809509277, 9.353327751159668, 9.35612678527832, 9.378217697143555, 9.468523979187012, 9.327244758605957, 9.512613296508789, 9.613329887390137]
# # resnet_lips = [0.8205103278160095, 1.2354673147201538, 5.896811008453369, 10.773021697998047, 12.26617431640625, 11.8272705078125, 11.231945991516113, 11.880779266357422, 14.64172649383545, 13.051780700683594, 12.633347511291504, 12.856369018554688, 15.866037368774414, 17.063302993774414, 16.329973220825195, 15.563969612121582, 15.120752334594727, 13.860235214233398, 13.737691879272461, 13.669340133666992, 16.00725746154785, 17.933853149414062, 16.574512481689453, 16.176097869873047, 15.308272361755371, 13.538276672363281, 12.42896556854248, 11.753872871398926, 11.337986946105957, 12.282922744750977, 11.874183654785156, 13.25146198272705, 13.084643363952637, 11.676956176757812, 11.853753089904785, 11.329429626464844, 11.518628120422363, 11.406614303588867, 10.173327445983887, 11.28798770904541, 11.940433502197266, 11.769465446472168, 10.960740089416504, 11.910052299499512, 10.674578666687012, 10.868803977966309, 11.178398132324219, 11.142651557922363, 10.823960304260254, 10.372247695922852, 11.19643497467041, 10.254181861877441, 9.50937271118164, 10.579972267150879, 10.16665267944336, 11.256918907165527, 9.502242088317871, 9.697440147399902, 9.974084854125977, 9.0655517578125, 9.569962501525879, 9.386974334716797, 9.156092643737793, 9.091836929321289, 9.107194900512695, 8.692028045654297, 8.186935424804688, 8.12591552734375, 8.02271842956543, 8.101634979248047, 7.956390857696533, 7.68943977355957, 7.705882549285889, 7.520922660827637, 7.324650287628174, 7.192885398864746, 6.738373279571533, 6.672155857086182, 6.809110164642334, 6.762290954589844, 6.849081993103027, 6.604490280151367, 6.528766632080078, 6.539067268371582, 6.25963020324707, 6.1850690841674805, 6.133457660675049, 6.234881401062012, 6.133485317230225, 5.973124027252197, 6.133496284484863, 5.957993030548096, 5.937183380126953, 5.886143684387207, 5.737912178039551, 5.725123405456543, 5.814277172088623, 5.618442058563232, 5.712732315063477, 5.660302639007568]
#
#
# epoch = list(range(0, len(iresnet_lips), 1))
# plt.figure()
# plt.plot(epoch, iresnet_lips, label= "iresnet_lips")
# # plt.plot(epoch, resnet_lips, label= "resnet_lips")
# # plt.plot(epoch, iresnet_lips_large_layerlips, label= "iresnet_lips_large_layerlips")
# plt.plot(epoch, iresnet_lips_no_padding, label= "iresnet_lips_no_padding")
# plt.grid()
# plt.legend()
# plt.show()
#
#

# Open and read the JSON file
import json
with open('iresnet_cifar10/record.json', 'r') as file:
    iresnet_data = json.load(file)
with open('resnet_cifar10/record.json', 'r') as file:
    resnet_data = json.load(file)
print(iresnet_data.keys())

train_epoch_acc_iresnet=iresnet_data["train_epoch_acc"]
train_epoch_loss_iresnet=iresnet_data["train_epoch_loss"]
estimated_lipschitz_iresnet=iresnet_data["estimated_lipschitz"]
test_acc_iresnet=iresnet_data["test_acc"]
train_acc_iresnet=train_epoch_acc_iresnet[-1]

train_epoch_acc_resnet=resnet_data["train_epoch_acc"]
train_epoch_loss_resnet=resnet_data["train_epoch_loss"]
estimated_lipschitz_resnet=resnet_data["estimated_lipschitz"]
test_acc_resnet=resnet_data["test_acc"]
train_acc_resnet=train_epoch_acc_resnet[-1]

print("iResNet Train acc:{},Test acc:{}".format(train_acc_iresnet,test_acc_iresnet))
print("ResNet Train acc:{},Test acc:{}".format(train_acc_resnet,test_acc_resnet))



fig, axs = plt.subplots(1, 3, figsize=(15, 4))



axs[0].plot(list(range(0, len(train_epoch_acc_iresnet), 1)), train_epoch_acc_iresnet, alpha=0.8,label="train_epoch_acc_iresnet")
axs[0].plot(list(range(0, len(train_epoch_acc_resnet), 1)), train_epoch_acc_resnet, alpha=0.8, label="train_epoch_acc_resnet")
axs[0].set_xlabel('epoch')
axs[0].set_ylabel('train acc')
axs[0].set_title('iResNet vs Resnet: Followed Pass')
axs[0].legend()

axs[1].plot(list(range(0, len(train_epoch_loss_iresnet), 1)), train_epoch_loss_iresnet, alpha=0.8,label="train_epoch_loss_iresnet")
axs[1].plot(list(range(0, len(train_epoch_loss_resnet), 1)), train_epoch_loss_resnet, alpha=0.8, label="train_epoch_loss_resnet")
axs[1].set_xlabel('epoch')
axs[1].set_ylabel('train loss')
axs[1].set_title('iResNet vs Resnet: Train Loss')
axs[1].legend()

axs[2].plot(list(range(0, len(estimated_lipschitz_iresnet), 1)), estimated_lipschitz_iresnet, alpha=0.8,label="estimated_lipschitz_iresnet")
axs[2].plot(list(range(0, len(estimated_lipschitz_resnet), 1)), estimated_lipschitz_resnet, alpha=0.8, label="estimated_lipschitz_resnet")
axs[2].set_xlabel('epoch')
axs[2].set_ylabel('lipschitz')
axs[2].set_title('iResNet vs Resnet: lipschitz')
axs[2].legend()


plt.show()